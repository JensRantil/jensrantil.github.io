<!doctype html><html lang=en><head><title>My simplicity toolkit: Testing · Jens Rantil
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jens Rantil"><meta name=description content="Ways to keep your tests simple when programming."><meta name=keywords content="blog,developer,staff engineering,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="My simplicity toolkit: Testing"><meta name=twitter:description content="Ways to keep your tests simple when programming."><meta property="og:url" content="https://jensrantil.github.io/posts/software-testing-simplicity/"><meta property="og:site_name" content="Jens Rantil"><meta property="og:title" content="My simplicity toolkit: Testing"><meta property="og:description" content="Ways to keep your tests simple when programming."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-18T09:45:35+02:00"><meta property="article:modified_time" content="2024-04-02T14:46:06+02:00"><meta property="article:tag" content="Simplicity"><meta property="article:tag" content="Testing"><link rel=canonical href=https://jensrantil.github.io/posts/software-testing-simplicity/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm+MTzNJdv80k+n0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/custom.min.2e198fefc57dcc517a51f5b2040b841f014759bd551d4dd18df6dd0c1b954a62.css integrity="sha256-LhmP78V9zFF6UfWyBAuEHwFHWb1VHU3RjfbdDBuVSmI=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://jensrantil.github.io/>Jens Rantil
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/pages/services/>Services</a></li><li class=navigation-item><a class=navigation-link href=/pages/about-me/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://jensrantil.github.io/posts/software-testing-simplicity/>My simplicity toolkit: Testing</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-02-18T09:45:35+02:00>February 18, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
7-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/my-simplicity-toolkit/>My Simplicity Toolkit</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/simplicity/>Simplicity</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/testing/>Testing</a></span></div></div></header><div class=post-content><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content>This post is part of my blog series about <a href=/categories/my-simplicity-toolkit/><em>My Simplicity
Toolkit</em></a>. I highly suggest you read <a href=/posts/my-simplicity-toolkit/>the introductory post</a> before reading this one.</div></div><p>In <a href=/posts/my-simplicity-toolkit/>my initial post</a> on this blog post series I wrote about
the verb <a href="https://www.youtube.com/watch?si=AYiDh-n_KMwCLwl4&amp;t=1895&amp;v=SxdOUGdseq4&amp;feature=youtu.be" class=external-link target=_blank rel=noopener>&ldquo;to complect&rdquo;</a>. It means to braid something together. In
this article, I am giving examples of things related to testing that tend to be
unnecessarily complected together.</p><p>Building up a suite of maintainable tests is all about trying to avoid
complecting things unless truly necessary. Notice that complecting things
<em>is</em> necessary at times, just not always.</p><p>Tests are naturally complected with the implementation it is trying to verify.
If an implementation is broken, tests will, by design, (hopefully!) break.
However, all developers have a choice of how large of an implementation surface
a test should cover. Have a look at this figure:</p><p><img src=/posts/software-testing-simplicity/complected-tests.png alt="A drawing comparing how tests should test one and only one components behaviour."></p><p>Depending on which level of coupling between tests and implementation a
developer takes, you have vastly different levels of complexity. On the left
side, changing an implementation will cause a lot of tests to break. <a href=https://commandcenter.blogspot.com/2023/12/simplicity.html class=external-link target=_blank rel=noopener>Changing
an implementation becomes slower and slower</a> as you add more
tests. They will all need to be updated! If you instead take the route of the
right part of the figure, you will have a constant set of tests that will need
to be updated over time. My previous articles <a href=/posts/testing-strategy-over-time/>&ldquo;Testing strategy over
time&rdquo;</a> & <a href=/posts/narrow-integration-tests/>&ldquo;On narrow integration tests&rdquo;</a>
talks about this at length.</p><p>The following is a list of things I keep in my simplicity toolkit when it comes
to testing:</p><h2 id=test-outcome-over-implementation>Test outcome over implementation
<a class=heading-link href=#test-outcome-over-implementation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>In my introduction above I spoke about the cost of updating tests every time I
modify an implementation. It has a high cost.</p><p>To reduce the likelihood of that happening, tests should verify <em>what</em>
(outcome) is being done in an implementation, not <em>how</em> it&rsquo;s being done. In
other words, your tests should not depend on the inner nitty-gritty details of
an implementation. A different way of looking at it is that a rewrite of how a
class or a function does something shouldn&rsquo;t require changing any of the tests
as long as the outcome is the same. This will make refactoring a lot easier.</p><h3 id=other-test-doubles-over-mocks>Other test doubles over mocks
<a class=heading-link href=#other-test-doubles-over-mocks><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p><a href=https://martinfowler.com/bliki/TestDouble.html class=external-link target=_blank rel=noopener>According to Martin Fowler</a>, a &ldquo;test double&rdquo; is</p><blockquote><p>[&mldr;] a generic term for any case where you replace a production object for
testing purposes.</p></blockquote><p>Mocks, spies, fakes, stubs, and dummies are all examples of test doubles.
Fowler further defines a Mock as</p><blockquote><p>[&mldr;] pre-programmed with expectations which form a specification of the
calls they are expected to receive.</p></blockquote><p>As already stated in the previous section, tests should be coupled to outcome,
not implementation. Mocks tend to be horrible when it comes to this. You send
in an object into your implementation and it&rsquo;s preprogrammed exactly how it
should behave depending on the implementation. I think <a href="https://youtu.be/EZ05e7EMOLM?si=8hI8sZ-8ZYmyB7I8&amp;t=533" class=external-link target=_blank rel=noopener>Ian Cooper explains it
quite well here</a>.</p><p>Another problem with mocks is that they tend to be quite complex to use. I
programmed professionally in Java for many many years and still had to look up
things in the reference documentation for <a href=https://site.mockito.org/ class=external-link target=_blank rel=noopener>Mockito</a>. Other types of
test doubles tend to be much simpler to use and understand.</p><p>Strictly speaking, I only see two use cases for mocks:</p><ul><li>If I am coding in a strictly typed programming language, and I am using a
third-party library that does not adhere to the <a href=https://en.wikipedia.org/wiki/Dependency_inversion_principle class=external-link target=_blank rel=noopener>dependency inversion
principle</a>. Ie., it doesn&rsquo;t have interfaces that I can implement to
change its internal behavior of it.</li><li>Certain hackery when it comes to third-party libraries that use <code>static</code>s
and <a href=https://refactoring.guru/design-patterns/singleton class=external-link target=_blank rel=noopener>singletons</a>.</li></ul><p>I avoid mocks as much as I can. I guess that makes me <a href=https://martinfowler.com/articles/mocksArentStubs.html class=external-link target=_blank rel=noopener>a classicist tester</a>.</p><h2 id=givenwhenthen-over-unclarity-what-is-being-tested>Given/When/Then over unclarity what is being tested
<a class=heading-link href=#givenwhenthen-over-unclarity-what-is-being-tested><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>A common structure for automated tests is to split them up in three stages,
<a href=https://martinfowler.com/bliki/GivenWhenThen.html class=external-link target=_blank rel=noopener>&ldquo;Given, When, Then&rdquo;</a> or <a href=https://java-design-patterns.com/patterns/arrange-act-assert/ class=external-link target=_blank rel=noopener>&ldquo;Arrange, Act,
Assert&rdquo;</a> (two variants of the same thing). Here is an
example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_test</span>():
</span></span><span style=display:flex><span>  <span style=color:#75715e># Given two numbers:</span>
</span></span><span style=display:flex><span>  a <span style=color:#f92672>=</span> random_number()
</span></span><span style=display:flex><span>  b <span style=color:#f92672>=</span> random_number()
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># When I call the sum function:</span>
</span></span><span style=display:flex><span>  c <span style=color:#f92672>=</span> sum([a, b])
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># Then the result should be the sum of the numbers</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>assert</span> c <span style=color:#f92672>==</span> a <span style=color:#f92672>+</span> b
</span></span></code></pre></div><p>Compare the above test to this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_test</span>():
</span></span><span style=display:flex><span>  a <span style=color:#f92672>=</span> random_number()
</span></span><span style=display:flex><span>  b <span style=color:#f92672>=</span> random_number()
</span></span><span style=display:flex><span>  c <span style=color:#f92672>=</span> sum([a, b])
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>assert</span> c <span style=color:#f92672>==</span> a <span style=color:#f92672>+</span> b
</span></span></code></pre></div><p>The latter example makes it unclear what it is trying to test; Are we checking
if the results return from <code>random_number()</code> can be summed? Or are we checking
that the behavior of <code>sum(...)</code> behaves as we expect?</p><blockquote><p>&ldquo;I don&rsquo;t dare to remove this test, because it might be testing something
there isn&rsquo;t a test for elsewhere.&rdquo;</p></blockquote><p>If we don&rsquo;t clarify what we are testing (When or Act), developers don&rsquo;t dare to
remove tests over time. Suddenly we have a large evergrowing test suite -
complecting our tests with implementation more and more. You end up having to
update tons of tests every time you make a change to an implementation.</p><p>The above problem can be a huge headache in larger code bases.</p><h3 id=naming-test-by-outcome-over-how>Naming test by outcome over how
<a class=heading-link href=#naming-test-by-outcome-over-how><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Related to the above, it&rsquo;s important to <em>name</em> your tests for the behavior
they are testing, not how it is being done. This includes mentioning the
expected outcome. For my example tests above,
<code>testThatTwoRandomNumbersSumUpCorrectly</code> is a much better name that
<code>testThatSumLoopingWorks</code>. That the <code>sum(...)</code> function uses a loop internally
is irrelevant. And &ldquo;works&rdquo; says nothing of the expected outcome.</p><p><a href=https://osherove.com/blog/2005/4/3/naming-standards-for-unit-tests.html class=external-link target=_blank rel=noopener>This article</a> looks to be a good one when it comes to the naming of
tests if you would like to know more.</p><h2 id=unit-tests-over-integration-tests>Unit tests over integration tests
<a class=heading-link href=#unit-tests-over-integration-tests><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>An integration test is a test that, by definition, tests multiple units
together. Compare that to a unit test which by definition only tests a single
unit. This means, by definition, that <em>an integration test</em> complects with more
parts of your implementation.</p><p>My article <a href=/posts/testing-strategy-over-time/>&ldquo;Testing Strategy Over Time&rdquo;</a> talked about this
at length.</p><p>This practice aligns very well with the classical <a href=https://martinfowler.com/bliki/TestPyramid.html class=external-link target=_blank rel=noopener>Testing
Pyramid</a>.</p><h2 id=narrow-integration-tests-over-general-integration-tests>Narrow integration tests over (general) integration tests
<a class=heading-link href=#narrow-integration-tests-over-general-integration-tests><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>&mldr;and if I write an integration test, I make it narrow. <em>Narrow</em> in this case
means that to test an integrated set of units, I test how they integrate and
work with each other pairwise. If they all work well with each other pairwise
(narrow integration test), there is no need to test them altogether (wide
integration test).</p><p>For example, I test that two layers in my application interact the way they
should, instead of testing all layers together. This means, that I don&rsquo;t need
an actual database to test the HTTP controller layer. Instead, I make sure that
the HTTP layer delegates calls properly to the business/service layer, etc.</p><p>My article <a href=/posts/narrow-integration-tests/>&ldquo;On narrow integration tests&rdquo;</a> talked about
this at length.</p><h2 id=testing-in-production-over-end-to-end-tests>Testing in production over end-to-end tests
<a class=heading-link href=#testing-in-production-over-end-to-end-tests><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><div class="notice warning"><div class=notice-title><i class="fa-solid fa-exclamation-triangle" aria-hidden=true></i>Warning</div><div class=notice-content>Controversial!</div></div><p>Tests are in a way a liability. There is a cost to maintaining them. The wider
the integration tests, the higher the cost over time. The widest possible
integration tests, and thus the most expensive to maintain, is an end-to-end
test. It is a test that starts up your entire application, needing all your
supporting infrastructure in place (databases, queues, caches&mldr;), to be able
to run.</p><p>The most realistic test is the one when a user tests any functionality. Nothing
can beat it. Users will double click on the buttons you&rsquo;ve only clicked once,
and they will enter 1000 characters in the text field you entered 10
characters.</p><p>While, having an automated test that makes sure you application can start <em>can</em>
be useful, getting it out in production to test with actual users has the
benefit of getting feedback quicker and not slowing down your development with
<a href=/posts/testing-strategy-over-time/>complex, slow, and brittle tests</a>.</p><p>Don&rsquo;t get me wrong, though! To be able to test in production you need a good
foundation:</p><ul><li>Quick deploys.</li><li>A solid CI/CD system that can do a gradual rollout.</li><li>A feature flag system to toggle new features for a subset of users.</li><li>Solid observability in place to understand the success rate for user
behaviours.</li></ul><h2 id=references>References
<a class=heading-link href=#references><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li><a href="https://www.youtube.com/watch?v=EZ05e7EMOLM" class=external-link target=_blank rel=noopener>YouTube - 🚀 TDD, Where Did It All Go Wrong (Ian Cooper)</a></li><li>Matt Schellhas&rsquo;s <a href=https://matt-schellhas.medium.com/the-five-minute-guide-to-useful-unit-tests-5f675eff01be class=external-link target=_blank rel=noopener>Six Minute Guide to Useful Unit Tests</a></li></ul></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2025
Jens Rantil
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.
[<a href=https://github.com/JensRantil/jensrantil.github.io/tree/e17e2f4d121f3656d7fb895f8a6e9311a695bc34 target=_blank rel=noopener>e17e2f4</a>]</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8QE7N3YHJ3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8QE7N3YHJ3")</script></body></html>