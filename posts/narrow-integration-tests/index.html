<!doctype html><html lang=en><head><title>On narrow integration tests · Jens Rantil
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jens Rantil"><meta name=description content="Narrow integration tests are tests that only involve very few components,
mostly relying on test
doubles to simulate
external dependencies. As always, we have Martin Fowler to thank for yet
another excellent
article on integration
tests so I&rsquo;ll simply refer to that for the details of what a narrow integration
test is.
That said, during 2019 I have grown increasingly convinced that the distinction
between a narrow and wide integration (also know as system tests or end-to-end tests) is an important one, for two reasons:"><meta name=keywords content="blog,developer,staff engineering,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="On narrow integration tests"><meta name=twitter:description content="Narrow integration tests are tests that only involve very few components, mostly relying on test doubles to simulate external dependencies. As always, we have Martin Fowler to thank for yet another excellent article on integration tests so I’ll simply refer to that for the details of what a narrow integration test is.
That said, during 2019 I have grown increasingly convinced that the distinction between a narrow and wide integration (also know as system tests or end-to-end tests) is an important one, for two reasons:"><meta property="og:url" content="https://jensrantil.github.io/posts/narrow-integration-tests/"><meta property="og:site_name" content="Jens Rantil"><meta property="og:title" content="On narrow integration tests"><meta property="og:description" content="Narrow integration tests are tests that only involve very few components, mostly relying on test doubles to simulate external dependencies. As always, we have Martin Fowler to thank for yet another excellent article on integration tests so I’ll simply refer to that for the details of what a narrow integration test is.
That said, during 2019 I have grown increasingly convinced that the distinction between a narrow and wide integration (also know as system tests or end-to-end tests) is an important one, for two reasons:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-30T09:49:00+02:00"><meta property="article:tag" content="Testing"><meta property="article:tag" content="Simplicity"><meta property="article:tag" content="System Testing"><meta property="article:tag" content="Integration Testing"><meta property="article:tag" content="End-to-End Testing"><link rel=canonical href=https://jensrantil.github.io/posts/narrow-integration-tests/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm+MTzNJdv80k+n0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/custom.min.2e198fefc57dcc517a51f5b2040b841f014759bd551d4dd18df6dd0c1b954a62.css integrity="sha256-LhmP78V9zFF6UfWyBAuEHwFHWb1VHU3RjfbdDBuVSmI=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://jensrantil.github.io/>Jens Rantil
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/pages/services/>Services</a></li><li class=navigation-item><a class=navigation-link href=/pages/about-me/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://jensrantil.github.io/posts/narrow-integration-tests/>On narrow integration tests</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2020-01-13T00:00:00Z>January 13, 2020
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/testing/>Testing</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/simplicity/>Simplicity</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/system-testing/>System Testing</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/integration-testing/>Integration Testing</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/end-to-end-testing/>End-to-End Testing</a></span></div></div></header><div class=post-content><p><em>Narrow integration tests</em> are tests that only involve very few components,
mostly relying on <a href=https://martinfowler.com/articles/mocksArentStubs.html class=external-link target=_blank rel=noopener>test
doubles</a> to simulate
external dependencies. As always, we have Martin Fowler to thank for yet
another excellent
<a href=https://martinfowler.com/bliki/IntegrationTest.html class=external-link target=_blank rel=noopener>article</a> on integration
tests so I&rsquo;ll simply refer to that for the details of what a narrow integration
test is.</p><p>That said, during 2019 I have grown increasingly convinced that the distinction
between a narrow and wide integration (also know as <em>system tests</em> or <em>end-to-end tests</em>) is an important one, for two reasons:</p><p>First, given that narrow integration tests depends on very few components the
<a href=https://jensrantil.github.io/posts/testing-strategy-over-time/>cost of maintenance is very low</a>. Compare this to wide
integration tests where cost of maintaining them increases with number of
components and/or software complexity.</p><p>Secondly, because I believe a large majority of the wide integration tests can
be replaced by a set of narrow integration tests. The benefit would be a more
maintainable test suite over time, with equal confidence that it catches bugs.
Let me explain:</p><p>A common counter-argument against unit and narrow integration testing is that
they don&rsquo;t test the application as a whole. In one way, this is true, but you
could also look at <em>a whole as an overlap of many smaller pieces</em>. For example,
a lot of software architecture models involves thinking in layers (<a href=https://en.wikipedia.org/wiki/Hexagonal_architecture_%28software%29 class=external-link target=_blank rel=noopener>Hexagonal
architecture</a>,
<a href=https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html class=external-link target=_blank rel=noopener>Clean
architecture</a>
and more). So, let&rsquo;s imagine a very simple application that receives an HTTP
API call, does some business logic and stores something in a database:</p><p><a href=narrow-integration-tests.png><img src=/posts/narrow-integration-tests/narrow-integration-tests.png alt="Narrow integration tests"></a></p><p>An API call from the Internet flows through each layer of our application. With
input being validated and transformed as it passes through layers towards
persistence, and result/output from the final persistence eventually trickling
back to the API caller.</p><p>A growing hypothesis of mine is that <em>it&rsquo;s very unlikely that bugs are
introduced by miscommunication between non-adjacent layers</em>. This means, that
as long you have made sure to test each layer boundary, you should in be pretty
confident that the application works as a whole. For example, in the image
above, you can see that all the curly braces to the right are overlapping. Each
curly brace is a set of narrow integration tests.</p><p>Could there be bugs that are introduced by pairs on non-adjacent layers? Yes,
but like I said very unlikely. Ignoring when you&rsquo;ve actually missed a narrow
integration test case, you <em>might</em> see issues such as</p><ul><li>application using too much resources (CPU, memory, I/O&mldr;) when all
components are put together.</li><li>low-level concurrency-related issues.</li><li>memory corruption bugs.</li></ul><p>These days, bugs like these are pretty uncommon. My recommendation is that you
focus on implementing those narrow integration tests first if you can.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2025
Jens Rantil
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.
[<a href=https://github.com/JensRantil/jensrantil.github.io/tree/3eedd58725fdb26285611febe0a86793a3a68825 target=_blank rel=noopener>3eedd58</a>]</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8QE7N3YHJ3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8QE7N3YHJ3")</script></body></html>