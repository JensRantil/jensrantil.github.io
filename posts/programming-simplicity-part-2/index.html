<!doctype html><html lang=en><head><title>My simplicity toolkit: Programming (part 2) · Jens Rantil
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jens Rantil"><meta name=description content="Simple software programming preferences in my simplicity toolbox. Part 2."><meta name=keywords content="blog,developer,staff engineering,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="My simplicity toolkit: Programming (part 2)"><meta name=twitter:description content="Simple software programming preferences in my simplicity toolbox. Part 2."><meta property="og:url" content="https://jensrantil.github.io/posts/programming-simplicity-part-2/"><meta property="og:site_name" content="Jens Rantil"><meta property="og:title" content="My simplicity toolkit: Programming (part 2)"><meta property="og:description" content="Simple software programming preferences in my simplicity toolbox. Part 2."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-14T23:00:35+02:00"><meta property="article:modified_time" content="2024-02-19T09:52:22+01:00"><meta property="article:tag" content="Simplicity"><link rel=canonical href=https://jensrantil.github.io/posts/programming-simplicity-part-2/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm+MTzNJdv80k+n0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/custom.min.2e198fefc57dcc517a51f5b2040b841f014759bd551d4dd18df6dd0c1b954a62.css integrity="sha256-LhmP78V9zFF6UfWyBAuEHwFHWb1VHU3RjfbdDBuVSmI=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://jensrantil.github.io/>Jens Rantil
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/pages/services/>Services</a></li><li class=navigation-item><a class=navigation-link href=/pages/about-me/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://jensrantil.github.io/posts/programming-simplicity-part-2/>My simplicity toolkit: Programming (part 2)</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2023-11-14T23:00:35+02:00>November 14, 2023
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
12-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/my-simplicity-toolkit/>My Simplicity Toolkit</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/simplicity/>Simplicity</a></span></div></div></header><div class=post-content><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content><p>This is the second part of two talking about my simplicity toolkit when
programming. If you have not read <a href=/posts/programming-simplicity-part-1/>the previous post</a> I highly
encourage you to do so first.</p><p>This post is part of my blog series about <a href=/categories/my-simplicity-toolkit/><em>My Simplicity
Toolkit</em></a>.</p></div></div><p>At the beginning of <a href=/posts/programming-simplicity-part-1/>my previous post</a> about simplicity within
programming, I talked about the numerous benefits that bringing simplicity to
<a href=programming>programming</a> can be: Easy to understand, use, debug, etc.</p><p>Choosing simplicity can be radical, and choosing it means taking a stance
<em>against something</em>. I have therefore decided to formulate all my simplicity
tools as &ldquo;X over Y&rdquo;. The following preferences are a continuation of the
previous post:</p><h2 id=sql-over-orm>SQL over ORM
<a class=heading-link href=#sql-over-orm><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>SQL is the lingua franca of working with data stored in databases. SQL is
interactive, which makes it easy to manually build exactly the queries
we want. SQL is also powerful & flexible, allowing us to transform, filter,
sort, group, pivot our data, and more.</p><p>The most basic idea with ORMs (<em>Object Relational Mappers</em>) is to map SQL query
results to objects. While that can be a bit of manual work, let&rsquo;s be honest,
manual mapping is not a <em>lot</em> of work and is usually done <em>once</em>. And assuming you
have automated tests of your persistence layer (right??), typos should be
caught before being shipped.</p><p>The problem with ORMs is that they have vastly expanded beyond the mapping
functionality. They support lazy loading, proxy objects, eager loading,
cascading deletes, have <a href=#my-own-interfaces-over-3rd-party-interfaces>giant interfaces</a>, and more.
Most ORMs are not simple anymore and I keep ending up googling how to do various
tasks in them.</p><p>Oh, a note on SQL injections: There are DSL query builders that protect you
from that. And linters. You don&rsquo;t need a big ORM to avoid SQL injections.</p><p>In short, I believe there is generally so much complexity in most ORMs that we
are better off not using them.</p><p>Finally, SQL is timeless and ORMs are not. SQL has stood the test of time. ORMs
are 3rd party libraries that come and go or get modified over time. I prefer
to invest my knowledge in timeless solutions first.</p><h2 id=high-level-code-up-the-callstack-over-low-level>High-level code up the callstack over low-level
<a class=heading-link href=#high-level-code-up-the-callstack-over-low-level><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Here is a small Python program:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> functools <span style=color:#f92672>import</span> reduce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_sum_of_squared</span>():
</span></span><span style=display:flex><span>    numbers <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        user_input <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Enter a number (enter &#39;0&#39; to finish): &#34;</span>)
</span></span><span style=display:flex><span>        num <span style=color:#f92672>=</span> float(user_input)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        numbers<span style=color:#f92672>.</span>append(num)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> reduce(<span style=color:#66d9ef>lambda</span> acc, value: acc <span style=color:#f92672>+</span> (value <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>), numbers, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Sum of numbers:&#34;</span>, result)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    calculate_sum_of_squared()
</span></span></code></pre></div><p>It does everything in one function, <code>calculate_sum_of_squared()</code>. Compare that to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> functools <span style=color:#f92672>import</span> reduce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_numbers_from_terminal</span>():
</span></span><span style=display:flex><span>    numbers <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        user_input <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Enter a number (enter &#39;0&#39; to finish): &#34;</span>)
</span></span><span style=display:flex><span>        num <span style=color:#f92672>=</span> float(user_input)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        numbers<span style=color:#f92672>.</span>append(num)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> numbers
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_sum_of_squared</span>(numbers):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> reduce(<span style=color:#66d9ef>lambda</span> acc, value: acc <span style=color:#f92672>+</span> (value <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>), numbers, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    numbers <span style=color:#f92672>=</span> get_numbers_from_terminal()
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> calculate_sum_of_squared(numbers)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Sum of numbers:&#34;</span>, result)
</span></span></code></pre></div><p>The latter example has high-level code at the top of the callstack in <code>if __name__ == "__main__"</code>. You can easily see that the program is split into two
stages, first asking the user for numbers, followed by making a calculation.</p><p>Another thing that is different is that the most <em>low-level</em>, the <code>reduce(...)</code>
function call has been moved into a smaller function as deep into the callstack
as possible. By doing so, we can put a name on what it does. Parsing what
<code>reduce(lambda acc, value: acc + (value ** 2), numbers, 0)</code> means is not
simple.</p><h2 id=layered-software-architecture-over-mixing-transport-business-logic-or-persistence>Layered software architecture over mixing transport, business logic, or persistence
<a class=heading-link href=#layered-software-architecture-over-mixing-transport-business-logic-or-persistence><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Most applications I have worked with have three layers:</p><ul><li>The <strong>external API</strong> layer. This is the layer that handles the input and
output of your application. It works with <a href=https://en.wikipedia.org/wiki/Data_transfer_object class=external-link target=_blank rel=noopener>data-transfer objects
(DTOs)</a> and business models and converts between them. Data-transfer
objects are usually used for JSON marshaling/unmarshalling. Business models
are the most natural representation to implement your business logic.</li><li>The <strong>business</strong> layer where all my business logic is implemented. It works
with business models only.</li><li>The <strong>persistence</strong> layer which deals with storing and reading up things
from a database. It takes in and returns business models. It can optionally
use persistence objects if an ORM is used. The persistence layer is where <a href=/posts/programming-simplicity-part-1/#side-effect-free-code-over-side-effects>a
Repository</a> implementation resides.</li></ul><p>Over and over again I have seen classes conflate (or shall I
say&mldr;<a href="https://youtu.be/~KMwCLwl4&amp;t=1895" class=external-link target=_blank rel=noopener>complect</a>?) DTOs, business models, and persistence entities,
and being used in multiple of these layers. An example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> com.fasterxml.jackson.annotation.JsonProperty;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.Entity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.GeneratedValue;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.GenerationType;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.Id;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.Serializable;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Entity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ConflatedClass</span> <span style=color:#66d9ef>implements</span> Serializable {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Id</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GeneratedValue</span>(strategy <span style=color:#f92672>=</span> GenerationType.<span style=color:#a6e22e>IDENTITY</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>long</span> databaseId;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@JsonProperty</span>(<span style=color:#e6db74>&#34;fullName&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ConflatedClass</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Default constructor required by Hibernate</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ConflatedClass</span>(String name, <span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getDatabaseId</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> databaseId;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@JsonProperty</span>(<span style=color:#e6db74>&#34;fullName&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setName</span>(String name) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAge</span>(<span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>By mixing JSON, and persistence and using this object for business logic, most
of our commits must work across all the layers of your application from the
REST API down to the persistence layer. This leads to larger commits and more
bugs. It also makes it hard to migrate to a different type of database or
switch JSON library. It also usually creates a strong coupling between which
database is used.</p><p>The alternative would be to have three classes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> com.fasterxml.jackson.annotation.JsonProperty;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PersonDTO</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@JsonProperty</span>(<span style=color:#e6db74>&#34;fullName&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>PersonDTO</span>(String name, <span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String occupation;  <span style=color:#75715e>// Additional business model fields if needed</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Person</span>(String name, <span style=color:#66d9ef>int</span> age, String occupation) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>occupation</span> <span style=color:#f92672>=</span> occupation;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getOccupation</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> occupation;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setOccupation</span>(String occupation) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>occupation</span> <span style=color:#f92672>=</span> occupation;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.Entity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.GeneratedValue;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.GenerationType;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> javax.persistence.Id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Entity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PersistedPerson</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Id</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GeneratedValue</span>(strategy <span style=color:#f92672>=</span> GenerationType.<span style=color:#a6e22e>IDENTITY</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>long</span> databaseId;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>PersistedPerson</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Default constructor required by Hibernate</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>PersistenceModel</span>(String name, <span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>getDatabaseId</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> databaseId;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setName</span>(String name) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAge</span>(<span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>A common complaint about having three different classes is that mapping between
these classes is cumbersome. That&rsquo;s a feature, not a bug! By explicitly
mapping, you understand what is happening, and it gives you more flexibility.
Besides mapping is simple and quick - and there <em>are</em> <a href=https://modelmapper.org class=external-link target=_blank rel=noopener>libraries for
it</a> if you do need it.</p><p>The Internet is full of articles about layered architecture, but if you would
like to get started I highly recommend reading about <a href=https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html class=external-link target=_blank rel=noopener>The Clean
Architecture</a> (a superset of all variants of layered
architectures), and possibly <a href=https://www.goodreads.com/book/show/179133.Domain_Driven_Design class=external-link target=_blank rel=noopener>the Domain-Driven Design book</a>.</p><h2 id=ci-over-startup>CI over startup
<a class=heading-link href=#ci-over-startup><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>I prefer to do things at CI than when my application starts if I can. Examples:</p><ul><li>Package static resources.</li><li>Compress resources if I can.</li></ul><p>By doing this, I catch issues earlier at CI than after deployment. This also
has the added benefit that my application tends to start up faster.</p><p>This blog is actually a great example of this. It is a set of static HTML files
that get generated by the CI. This means I don&rsquo;t need any runtime to serve it
and can publish it using Github Pages for free. &#x2728;</p><h2 id=boot-phase-over-request-phase>Boot phase over request phase
<a class=heading-link href=#boot-phase-over-request-phase><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>I tend to think of REST services as generally having three stages:</p><ol><li><strong>Boot.</strong> When the application starts.</li><li><strong>Serve.</strong> When the application is serving requests.</li><li><strong>Shutdown.</strong> When the application, refuses new requests, drains ongoing
requests and shuts down.</li></ol><p>I try to do as much as possible during the boot phase instead of when serving.
For example, if I can read up some small data from the database and store it as
an in-memory immutable object for the rest of the application, I prefer that
over having to read from the database on every API call.</p><p>This has the following benefits:</p><ul><li><strong>Fewer incidents.</strong> If anything goes wrong during boot, the application
shuts down, health checks don&rsquo;t pass, and no users are impacted.</li><li><strong>Easier to test.</strong> Testing code run when booting doesn&rsquo;t require setting up
an HTTP server.</li><li><strong>More performant.</strong> By moving work to boot, each request needs to do less
work. By definition, the API becomes more performant.</li><li><strong>Thread-safety.</strong> I tend to store the things done at boot as <a href=https://github.com/google/guava/wiki/ImmutableCollectionsExplained class=external-link target=_blank rel=noopener>immutable
datastructures</a> during the serving phase. By doing so, I know
they are thread-safe and can be read by multiple concurrent threads.</li></ul><p>You can read more about this in <a href=/posts/lifecycles-and-states/>I&rsquo;m a State Engineer. Are you,
too?</a>.</p><h2 id=thread-unsafe-over-thread-safe-code>Thread-unsafe over thread-safe code
<a class=heading-link href=#thread-unsafe-over-thread-safe-code><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Writing thread-safe code is <em>hard</em> and error-prone. On top of it, it usually
comes with parameters that must be tweaked in terms of queue limits, ordering
promises, and concurrency limits. Thread-safe code also tends to be less
performant; locks need to be taken and synchronization needs to happen.</p><p>This is why I try to push thread safety up the stack. Unless it&rsquo;s <a href=https://github.com/JensRantil/conc class=external-link target=_blank rel=noopener>a
concurrency-related library</a>, I expect the user of my library to deal
with concurrency, not me.</p><h2 id=synchronous-over-asynchronous>Synchronous over asynchronous
<a class=heading-link href=#synchronous-over-asynchronous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><blockquote><p>Our REST API is slow! We need to make it asynchronous!</p></blockquote><p>Congratulations! You now have many new problems to solve:</p><ul><li>How should the user know that the API request is finished? Webhooks?
Long-polling? An e-mail? Polling?<ul><li>If a user submitted 100k async requests, will you be able to handle the
pressure of all the poll calls?</li></ul></li><li>If the user makes two requests to modify the same resource, which request
wins?</li><li>How will you handle if your async process always crashes, or a new
deployment happens while it&rsquo;s running?</li><li>How will you handle if the user submits 100k async requests? Will Redis be
able to store all the tasks?</li><li>How will you make sure that one user doesn&rsquo;t saturate the queue for 30
minutes impacting all other users?</li><li>You will eventually need to start maintaining priorities between different
types of tasks.</li><li>You will now need to maintain concurrency-related limits such as queue
depths and concurrency limits.</li></ul><p>On top of the above, asynchronicity spreads like wildfire to too many other
systems depending on your newly async API. This means that they, too, must
handle many of the problems above.</p><blockquote><p>Running my code is slow! I need to parallelize it!</p></blockquote><p>Congratulations! Similarly to the above, you now forever need to maintain
concurrency-related limits such as concurrency, and queue depths.</p><p>The alternatives to the above solutions are:</p><ul><li>Reconsider your data model. You likely got it wrong.</li><li>Auto-scaling (but <a href=/posts/autoscaling-not-a-panacea/>it&rsquo;s not a panacea</a>).</li><li><a href=https://cloud.google.com/blog/products/gcp/using-load-shedding-to-survive-a-success-disaster-cre-life-lessons class=external-link target=_blank rel=noopener>Load shedding.</a></li></ul><h2 id=working-code-over-pretty-code>Working code over pretty code
<a class=heading-link href=#working-code-over-pretty-code><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Code that does not work has no value to your business or your customers
(however, the process of creating <a href=https://en.wikipedia.org/wiki/Spike_%28software_development%29 class=external-link target=_blank rel=noopener>a spike</a> that doesn&rsquo;t work might
have!).</p><h2 id=pretty-code-over-performant-code>Pretty code over performant code
<a class=heading-link href=#pretty-code-over-performant-code><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><blockquote><p>Premature optimization is the root of all evil.</p><p>Sir Tony Hoare</p></blockquote><p>Code is read much more often than it is written. Pretty code is readable. It is
also implicitly easy to modify since it&rsquo;s easy to understand.</p><p>When it comes to performance, 99% of the time a program is spent in 1% of its
source code. This means that <em>performance usually is not of concern</em>. Instead,
figure out where your program spends time and optimize that only.</p><h2 id=standard-library-over-3rd-party-library>Standard library over 3rd party library
<a class=heading-link href=#standard-library-over-3rd-party-library><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Reusing code is not an end goal and will not make your code more maintainable
per se. Reuse complicated code but be aware that reusing code between two
different domains might make them depend on each other more than necessary.
Also remember that the more you reuse code, the more it needs to be
well-tested, otherwise you risk breaking lots of things with a tiny change.</p><p>Every third-party library is also a liability from a security perspective.
Hello TypeScript and Leftpad! &#x1f604;</p><p>Finally, if you want to invest your knowledge in something, invest in something
more timeless. The standard library will prevail but 3rd libraries will
not. They all eventually get replaced or changed.</p><h2 id=my-own-interfaces-over-3rd-party-interfaces>My own interfaces over 3rd party interfaces
<a class=heading-link href=#my-own-interfaces-over-3rd-party-interfaces><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>In a previous post, <a href=/posts/programming-simplicity-part-1/#side-effect-free-code-over-side-effects>I wrote about the repository pattern</a>. It
talked about how the repository pattern allows me to replace the implementation
of a repository. For example, at a previous employer, I migrated data from
MySQL to Cassandra <em>without having to rewrite any business logic</em>. This was
possible to do since I owned the repository interface myself.</p><p>However, there are <em>libraries</em> that ship with <code>interface</code>s. The problem with
such an interface is three-fold:</p><p>Firstly, the external interface is usually much larger than what you actually
need. You break <a href=https://en.wikipedia.org/wiki/Interface_segregation_principle class=external-link target=_blank rel=noopener>the Interface Segregation Principle</a>. For an ORM, maybe
you are fine with a simple key/value interface, but it gives you everything
from support for transactions to iterating over all the rows.</p><p>Secondly, when upgrading the library, you risk breaking a <em>lot</em> of code if the
upstream interface has changed. If you own the interface yourself, you will
only need to update the [bridge][bridge-patterm] between your interface and the
third-party library.</p><p>Third, a library interface also usually comes with implementations of its
interfaces. This means that the interface usually is highly coupled for the
union of <em>all</em> these implementations. For example, there is an ORM called
<a href=https://typeorm.io class=external-link target=_blank rel=noopener><code>TypeORM</code></a> that ships with support for a fixed list of databases.
However, that list does for example include <a href=https://cassandra.apache.org/_/index.html class=external-link target=_blank rel=noopener>Apache Cassandra</a>. The
<code>interface</code> for their &ldquo;repository&rdquo; might therefore not fit well with Cassandra.
Had you owned the interface yourself, you could cater it for the database
implementation you would need.</p><h2 id=simple-code-over-annotations>Simple code over annotations
<a class=heading-link href=#simple-code-over-annotations><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>A common thing many frameworks and libraries do is to use <code>@Annotation</code>s to
control validation, HTTP routing, SQL generation, OpenAPI documentation, and
more. I think annotations are an excellent example of where our industry is
choosing easy over simple. At a first glance, an annotation looks simple,
right?!</p><p>The thing is, it&rsquo;s usually very hard to understand the implication of an
annotation. The actual code handling the annotation is hidden inside a foreign
framework or library, leading to <a href=https://en.wikipedia.org/wiki/Action_at_a_distance_%28computer_programming%29 class=external-link target=_blank rel=noopener>Action at a Distance</a>.
Ever wondered in what order the annotations are handled in? Or the implications
of adding an ORM annotation to your SQL? Good luck.</p><p>The alternative is boring code, usually in a function. Want to validate your
DTO? How about implementing <code>validateMyDTO(): []error</code> and calling it when you
want to validate it? By doing this, you can debug your validation, write
(simple) tests for your validation, understand exactly where you validation is
being called in your IDE, and more. Less magic, more simplicity.</p><h2 id=conclusion>Conclusion
<a class=heading-link href=#conclusion><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>This post concludes summarising my simplicity toolkit when programming. Next up
is I will write about testing from the perspective of simplicity.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2026
Jens Rantil
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.
[<a href=https://github.com/JensRantil/jensrantil.github.io/tree/a34087af5f82d7816bdba0954b8e6726853453c5 target=_blank rel=noopener>a34087a</a>]</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8QE7N3YHJ3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8QE7N3YHJ3")</script></body></html>