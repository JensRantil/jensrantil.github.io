<!doctype html><html lang=en><head><title>Java's missing optional keyword and the issues of null · Jens Rantil
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Jens Rantil"><meta name=description content="One of my pet peaves when it comes to the Java programming languages
[1] is that it does not do enough type
safety. The issue is,
simply, that programmers tend to believe that Java infers more safety
than it actually does. The biggest reason for this can be summarized in
one word; null.
Let&rsquo;s face it, we&rsquo;ve all experienced a NullPointerException or two.
Why? Because we focus so much on which variable type to use. This makes
us tend to forget the simple fact that the variable might not have a
value at all; It can be null."><meta name=keywords content="blog,developer,staff engineering,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Java's missing optional keyword and the issues of null"><meta name=twitter:description content="One of my pet peaves when it comes to the Java programming languages [1] is that it does not do enough type safety. The issue is, simply, that programmers tend to believe that Java infers more safety than it actually does. The biggest reason for this can be summarized in one word; null.
Let’s face it, we’ve all experienced a NullPointerException or two. Why? Because we focus so much on which variable type to use. This makes us tend to forget the simple fact that the variable might not have a value at all; It can be null."><meta property="og:url" content="https://jensrantil.github.io/posts/the-issues-of-null/"><meta property="og:site_name" content="Jens Rantil"><meta property="og:title" content="Java's missing optional keyword and the issues of null"><meta property="og:description" content="One of my pet peaves when it comes to the Java programming languages [1] is that it does not do enough type safety. The issue is, simply, that programmers tend to believe that Java infers more safety than it actually does. The biggest reason for this can be summarized in one word; null.
Let’s face it, we’ve all experienced a NullPointerException or two. Why? Because we focus so much on which variable type to use. This makes us tend to forget the simple fact that the variable might not have a value at all; It can be null."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-22T00:13:45+02:00"><meta property="article:tag" content="Java"><meta property="article:tag" content="Programming"><link rel=canonical href=https://jensrantil.github.io/posts/the-issues-of-null/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm+MTzNJdv80k+n0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=stylesheet href=/custom.min.2e198fefc57dcc517a51f5b2040b841f014759bd551d4dd18df6dd0c1b954a62.css integrity="sha256-LhmP78V9zFF6UfWyBAuEHwFHWb1VHU3RjfbdDBuVSmI=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://jensrantil.github.io/>Jens Rantil
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/pages/services/>Services</a></li><li class=navigation-item><a class=navigation-link href=/pages/about-me/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://jensrantil.github.io/posts/the-issues-of-null/>Java's missing optional keyword and the issues of null</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2013-08-22T00:00:00Z>August 22, 2013
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
5-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/java/>Java</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/programming/>Programming</a></span></div></div></header><div class=post-content><p>One of my pet peaves when it comes to the Java programming languages
[1] is that it does not do enough <a href=https://en.wikipedia.org/wiki/Type_safety class=external-link target=_blank rel=noopener>type
safety</a>. The issue is,
simply, that programmers tend to believe that Java infers more safety
than it actually does. The biggest reason for this can be summarized in
one word; <code>null</code>.</p><p>Let&rsquo;s face it, we&rsquo;ve all experienced a <code>NullPointerException</code> or two.
Why? Because we focus so much on which variable type to use. This makes
us tend to forget the simple fact that the variable might not have a
value at all; It can be <code>null</code>.</p><p>Let&rsquo;s stop for a moment and think; In general, how many times should a
variables and parameters be nullable vs. non-nullable? I&rsquo;m not looking
for an exact number here, but I&rsquo;m sure you agree that most of your
method parameters are expected to be non-null. Heck, they need that
parameter to do what they are expected to execute. Still, they are
nullable.</p><p>This is interesting, because most Java code I&rsquo;ve seen goes against the
common notion of requiring a parameter (or variable). I see two gaps:</p><ul><li>the gap between the number of non-null expected parameters and the
number of times they are actually documented to be non-nullable.</li><li>the gap between the number of non-null expected parameters and the
number of times that the method actually makes sure that they are
not <code>null</code>.</li></ul><p>Now, this is the time you might say &ldquo;well, you&rsquo;ve just been reading
lousy Java code&rdquo;. I say, &ldquo;don&rsquo;t blame the messenger, this is because the
Java language is broken&rdquo;. I think that it&rsquo;s unrealistic that nullability
needs to be documented and checked for every parameter I add to a
method; I think it should be an inherent part of every programming
language to be explicit about optional values, because they are less
common.</p><h2 id=patching-the-java-language>Patching the Java language
<a class=heading-link href=#patching-the-java-language><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>One way to close this gap would be to introduce an <code>optional</code> keyword to
Java. All parameters <em>without</em> this keyword would not be allowed to be
nullable. If they happened to be, a <code>NullPointerException</code> would get
thrown.</p><p>For example, the call</p><pre tabindex=0><code>describe(null, &#34;My description&#34;);
</code></pre><p>with</p><pre tabindex=0><code>void describe(String name, optional String description) {
    ...
}
</code></pre><p>would throw an NullPointerException saying &ldquo;name is not allowed to be
null.&rdquo;</p><p>Obviously this would not be a backward compatible change and is never
gonna happen.</p><h2 id=a-workaround-for-a-broken-language>A workaround for a broken language
<a class=heading-link href=#a-workaround-for-a-broken-language><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>A couple of months ago I was recommended to have a look at <a href=https://code.google.com/p/guava-libraries/ class=external-link target=_blank rel=noopener>Google
Guava</a> by <a href=https://twitter.com/rwalker class=external-link target=_blank rel=noopener>Robby
Walker</a> at <a href=http://www.cueup.com class=external-link target=_blank rel=noopener>Cue</a>. I
stumbled across the
<a href=https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained#Optional class=external-link target=_blank rel=noopener>Optional</a>
implementation, and at first completely misunderstood what is was. This
was a good thing, because I instead came up with what I wanted it to be;
an immutable non-nullable wrapper.</p><p>My misunderstanding got me thinking and earlier today I <a href=https://gist.github.com/JensRantil/6294289 class=external-link target=_blank rel=noopener>sketched
out</a> an initial
implementation of what I though would be able to solve some of the gaps
mentioned earlier in this article. Here&rsquo;s the full implementation:</p><pre tabindex=0><code>import java.util.Map;
import java.util.Set;

/**
 * An immutable object reference that may not be null.
 * &lt;p&gt;
 * This class has two purposes:
 * &lt;ul&gt;
 * &lt;li&gt;it adds a clearly documents the fact that a variable must not be
 * &lt;code&gt;null&lt;/code&gt;.&lt;/li&gt;
 * &lt;li&gt;it helps users to catch possible {@link NullPointerException}s as early
 * as possible in the value chain.&lt;/li&gt;
 * &lt;li&gt;it minimizes the risk of forgetting to check for null values in
 * constructors.&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;/p&gt;
 * &lt;p&gt;
 * {@link NullPointerException}s are a misery in Java. Sadly, we have to live
 * with them and the best thing to deal with them is doing it as early as
 * possible in code. This class aims to help you with this.
 * &lt;/p&gt;
 * &lt;p&gt;
 * A note on immutability: This class i immutable/final because is keeps
 * hashCode and equals methods to always return the same result throughout the
 * life cycle of an instance. This makes is possible to have
 * {@link NonNullable}s in {@link Map}s and {@link Set}s etc.
 * &lt;/p&gt;
 * 
 * @author Jens Rantil &lt;jens.rantil@gmail.com&gt;
 *
 * @param &lt;V&gt; the type of the real value to hold
 */
public final class NonNullable&lt;V&gt; {

    /**
     * The real value that this class wraps.
     */
    private V value;

    /**
     * Contruct a {@link NonNullable} immutable.
     * @param initialValue the actual value. Must (duh!) be non-null.
     * @throws NullPointerException if initialValue is null.
     */
    public NonNullable(V initialValue) {
        if (initialValue == null) {
            throw new NullPointerException(&#34;Must not be null: &#34; + initialValue.toString());
        }
        this.value = initialValue;
    }

    /**
     * Get the actual non-null value.
     * @return value of type V. Never null.
     */
    public V get() {
        return value;
    }

    /**
     * Returns the (unmodified) {@link String} representation of the current
     * value.
     * 
     * @return a string.
     */
    @Override
    public String toString() {
        return value.toString();
    }

    /**
     * Returns a hash code value for the wrapped value object.
     * @see java.lang.Object#hashCode()
     */
    @Override
    public int hashCode() {
        return value.hashCode();
    }

    /**
     * Indicates whether some other object is &#34;equal to&#34; the wrapped value
     * object.
     * @see java.lang.Object#equals(java.lang.Object)
     */
    @Override
    public boolean equals(Object obj) {
        return value.equals(obj);
    }

}
</code></pre><p>The class makes it possible to document/infer non-nullability by type.
It also makes it possible to quickly catch most of the invalid <code>null</code>
values early on since they an exception is thrown in its exception.</p><p>The class obviously has some limitations:</p><ul><li>A <code>NonNullable</code> instance can too be null. However, I still think the
advantages outweighs the disadvantages.</li><li>It can be slightly more cumbersome to extract the value from a
<code>NonNullable</code> as you need to use the <code>get()</code> method.</li><li>Instantiation of <code>NonNullable</code> can be slow. This is mostly a
guess, though.</li></ul><h2 id=additional-notes>Additional notes
<a class=heading-link href=#additional-notes><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>The <a href=http://www.haskell.org class=external-link target=_blank rel=noopener>Haskell</a> programming language has <a href=https://en.wikipedia.org/wiki/Monad_%28functional_programming%29#The_Maybe_monad class=external-link target=_blank rel=noopener>the
Maybe
monad</a>
that handles this issue precisely the way I&rsquo;d like other programming
languages to do.</p><p><em>What do you think? Is this something that could be useful? Is null even
an issue in Java? Please comment below.</em></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2025
Jens Rantil
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.
[<a href=https://github.com/JensRantil/jensrantil.github.io/tree/cba53b20c33afbbecaa6fd8cc3149dd381e636f7 target=_blank rel=noopener>cba53b2</a>]</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-8QE7N3YHJ3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8QE7N3YHJ3")</script></body></html>